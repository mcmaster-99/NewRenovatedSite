{"code":"!function(e){var o={};function n(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=o,n.d=function(e,o,t){n.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,o){if(1&o&&(e=n(e)),8&o)return e;if(4&o&&\"object\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:e}),2&o&&\"string\"!=typeof e)for(var r in e)n.d(t,r,function(o){return e[o]}.bind(null,r));return t},n.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(o,\"a\",o),o},n.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},n.p=\"\",n(n.s=0)}([function(e,o,n){n(1),n(2),n(3),n(4),n(5),e.exports=n(6)},function(e,o){window.Inlo;var n=document.getElementById(\"notifs\");function t(e,o,n){var t=new Date;t.setTime(t.getTime()+24*n*60*60*1e3);var r=\"expires=\"+t.toUTCString();document.cookie=e+\"=\"+o+\";\"+r+\";path=/\"}!function(e){function o(o){var r=e(\"#emailInputSignin\").val(),i=e(\"#passwordInputSignin\").val();o.preventDefault(),function(o,n,t,r){var i={url:String(_config.api.inloApiUrl)+\"/v1/user/login\",crossDomain:!0,method:\"POST\",headers:{Accept:\"application/json\"},contentType:\"application/json\",data:JSON.stringify({email:o,password:n}),success:t,error:r};e.ajax(i).done(function(e){console.log(e)})}(r,i,function(e){console.log(\"Successfully Logged In\"),t(\"Authorization\",e.token,1),t(\"userID\",e.userID,1),window.location.href=\"dashboard.html\"},function(e){n.innerHTML=\"Your email or password is incorrect. Try again.\"})}function r(o){var t=e(\"#nameInputRegister\").val(),r=e(\"#emailInputRegister\").val(),i=e(\"#passwordInputRegister\").val(),a=e(\"#password2InputRegister\").val();o.preventDefault(),i===a?function(o,n,t,r,i){var a={url:String(_config.api.inloApiUrl)+\"/user/add\",crossDomain:!0,method:\"POST\",headers:{Accept:\"application/json\"},contentType:\"application/json\",data:JSON.stringify({name:o,email:n,password:t}),success:r,error:i};e.ajax(a).done(function(e){console.log(e),console.log(a)})}(t,r,i,function(e){console.log(e),console.log(\"user registered\");window.location.href=\"verify.html\"},function(e){console.log(e.status),409===e.status?n.innerHTML=\"Oops, that email is already registered.\":500===e.status&&(n.innerHTML=\"Sorry, there was an internal error.\")}):n.innerHTML=\"Passwords do not match.\"}e(function(){e(\"#signinForm\").submit(o),e(\"#registrationForm\").submit(r)})}(jQuery)},function(e,o){window._config={cognito:{userPoolId:\"us-west-2_EmZYHJNib\",userPoolClientId:\"1de9dc1303n9pdm0h7ljlsadvu\",identityPoolId:\"us-west-2:426460a4-e0a6-488b-aaa0-3d7ccab6a91a\",region:\"us-west-2\"},api:{coreFunctionsUrl:\"https://3mrhnqd4c4.execute-api.us-west-2.amazonaws.com/prod\",inloApiUrl:\"https://api.theinlo.com\"}}},function(e,o){throw new Error(\"Module parse failed: Unexpected token (25:11)\\nYou may need an appropriate loader to handle this file type.\\n|   // change code above this line\\n|   render() {\\n>     return <h1>{this.props.message}</h1>\\n|   }\\n| };\")},function(e,o,n){var t,r=window.WildRydes||{};r.map=r.map||{},t=jQuery,Promise.resolve().then(function(){var e=[!function(){var e=new Error(\"Cannot find module 'esri/Map'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),!function(){var e=new Error(\"Cannot find module 'esri/views/MapView'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),!function(){var e=new Error(\"Cannot find module 'esri/Graphic'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),!function(){var e=new Error(\"Cannot find module 'esri/geometry/Point'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),!function(){var e=new Error(\"Cannot find module 'esri/symbols/TextSymbol'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),!function(){var e=new Error(\"Cannot find module 'esri/symbols/PictureMarkerSymbol'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),!function(){var e=new Error(\"Cannot find module 'esri/geometry/support/webMercatorUtils'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),!function(){var e=new Error(\"Cannot find module 'dojo/domReady!'\");throw e.code=\"MODULE_NOT_FOUND\",e}()];(function(e,o,n,i,a,s,d){var l,c,u=r.map,m=new o({center:[-122.31,47.6],container:\"map\",map:new e({basemap:\"gray-vector\"}),zoom:12}),g=new a({color:\"#f50856\",text:\"Óòù\",font:{size:20,family:\"CalciteWebCoreIcons\"}}),f=new s({url:\"/images/unicorn-icon.png\",width:\"25px\",height:\"25px\"});function h(e){u.center={latitude:e.latitude,longitude:e.longitude}}function p(e){var o=d.xyToLngLat(e.xmin,e.ymin),n=d.xyToLngLat(e.xmax,e.ymax);u.extent={minLng:o[0],minLat:o[1],maxLng:n[0],maxLat:n[1]}}m.watch(\"extent\",p),m.watch(\"center\",h),m.then(function(){p(m.extent),h(m.center)}),m.on(\"click\",function(e){u.selectedPoint=e.mapPoint,m.graphics.remove(l),l=new n({symbol:g,geometry:u.selectedPoint}),m.graphics.add(l),t(u).trigger(\"pickupChange\")}),u.animate=function(e,o,t){var r,a=function(s){var d,l,u,g,h;r||(r=s),d=s-r,l=Math.min(d/2e3,1),g=(o.latitude-e.latitude)*l,h=(o.longitude-e.longitude)*l,u=new i({longitude:e.longitude+h,latitude:e.latitude+g}),m.graphics.remove(c),c=new n({geometry:u,symbol:f}),m.graphics.add(c),l<1?requestAnimationFrame(a):t()};requestAnimationFrame(a)},u.unsetLocation=function(){m.graphics.remove(l)}}).apply(null,e)}).catch(n.oe)},function(e,o,n){\"use strict\";SVG.on(document,\"DOMContentLoaded\",function(){var e=new SVG(\"svgGrid\").size(\"100%\",\"100%\").panZoom({zoomMin:.5,zoomMax:2,zoomFactor:.1}),o=[],n=[],t={},r=[],i=\"0\",a={},s=!1;e.on(\"panEnd\",function(o){e.viewbox().x,e.viewbox().y;console.log(e.viewbox())});(()=>{n=[],!0===s&&(e.clear(),o=[]),$.ajax({method:\"GET\",url:String(_config.api.inloApiUrl)+\"/v1/floorplan\",headers:{Authorization:\"Bearer \"+getAuth(\"Authorization\")},success:function(i){if(console.log(\"Response received from API: \",i),0===i.length)console.log(\"here\"),$(\"#map-view-text\").append(\"Map view not yet available\");else{r=i,n=JSON.stringify(i);for(let n=0;n<i.length;n++)if(i[n].rooms.length>0)for(let r=0;r<i[n].rooms.length;r++){let s=e.rect(i[n].rooms[r].width,i[n].rooms[r].height).attr({x:i[n].rooms[r].x,y:i[n].rooms[r].y,fill:\"white\",stroke:\"#E3E3E3\",\"stroke-width\":3});s.node.id=i[n].rooms[r].roomID;let l=s.node.id;o.push(s);let c=l+\"group\",u=e.group().addClass(c);if(u.add(s.addClass(c)),i[n].rooms[r].hasOwnProperty(\"nodes\"))for(let o=0;o<i[n].rooms[r].nodes.length;o++){let a=i[n].rooms[r].nodes[o].nodeID,s=d(l,a),m=s[0],g=s[1];t[a]={},t[a].Icon=e.image(\"images/inlo-device.png\",15,10),t[a].Icon.attr({x:m,y:g,fill:\"white\",stroke:\"#00D9AE\",id:a}),u.add(t[a].Icon.addClass(c))}a[l]=u}}s=!0},error:function(e,o,n){console.error(\"Error requesting devices: \",o,\", Details: \",n),console.error(\"Response: \",e.responseText)}})})();const d=(o,n)=>{let t,i,a,s;e.viewbox().x,e.viewbox().y,e.viewbox().zoom;var d=document.getElementById(o).instance.x()-document.getElementById(o).instance.transform().x,l=document.getElementById(o).instance.y()-document.getElementById(o).instance.transform().y,c=document.getElementById(o).instance.height(),u=document.getElementById(o).instance.width();for(let e=0;e<r.length;e++)for(let o=0;o<r[e].rooms.length;o++)if(r[e].rooms[o].hasOwnProperty(\"nodes\"))for(let t=0;t<r[e].rooms[o].nodes.length;t++)n===r[e].rooms[o].nodes[t].nodeID&&(a=r[e].rooms[o].nodes[t].x,s=r[e].rooms[o].nodes[t].y);return[t=a*u+d,i=s*c+l]};$(\"#done-btn\").click(function(){window.location.href=\"dashboard.html\"}),$(\"#cancel-btn\").click(function(){(()=>{if(1==confirm(\"Are you sure you want to cancel changes?\")){r=JSON.parse(n);for(let e=0;e<o.length;e++){let n=o[e].node.parentElement.id;$(\"#\"+String(n)).remove()}o=[];for(let n=0;n<r.length;n++)if(r[n].rooms.length>0)for(let i=0;i<r[n].rooms.length;i++){let s=e.rect(r[n].rooms[i].width,r[n].rooms[i].height).attr({x:r[n].rooms[i].x,y:r[n].rooms[i].y,fill:\"white\",stroke:\"#E3E3E3\",\"stroke-width\":3});s.node.id=r[n].rooms[i].roomID;let l=s.node.id;o.push(s);let c=l+\"group\",u=e.group().addClass(c);if(u.add(s.addClass(c)),r[n].rooms[i].hasOwnProperty(\"nodes\"))for(let o=0;o<r[n].rooms[i].nodes.length;o++){let a=r[n].rooms[i].nodes[o].nodeID,s=d(l,a),m=s[0],g=s[1];t[a]={},t[a].Icon=e.image(\"images/inlo-device.png\",15,10),t[a].Icon.attr({x:m,y:g,fill:\"white\",stroke:\"#E3E3E3\",id:a}),u.add(t[a].Icon.addClass(c))}a[l]=u}}})()}),$(\"#save-btn\").click(function(){(e=>{for(let e=0;e<r.length;e++){let n=r[e].floorID,t={rooms:r[e].rooms};$.ajax({method:\"PATCH\",url:String(_config.api.inloApiUrl)+\"/v1/floorplan/\"+n,headers:{Authorization:\"Bearer \"+getAuth(\"Authorization\")},data:t,success:o,error:function(e,o,n){console.error(\"Error requesting devices: \",o,\", Details: \",n),console.error(\"Response: \",e.responseText),alert(\"An error occured when requesting devices:\\n\"+e.responseText)}})}function o(e){let o=document.getElementById(\"saveModal\"),n=(document.getElementById(\"myBtn\"),document.getElementsByClassName(\"close\")[0]);o.style.display=\"block\",n.onclick=function(){o.style.display=\"none\"},window.onclick=function(e){e.target==o&&(o.style.display=\"none\")}}n=JSON.stringify(r)})()}),$(\"#print-data\").on(\"click\",function(){console.log(\"here\"),console.log(\"currentFloorPlan\",r),console.log(\"initialFloorPlanData\",n),console.log(\"floorPlanSvg\",o),console.log(\"floorPlanGroups\",a)}),$(\"#delete-rooms\").on(\"click\",function(){for(var e in a)a[e].node.children[0].instance.selectize(!1).resize(\"stop\");for(var n=0;n<o.length;n++){var t=o[n].node.id;$(\"#\"+t).on(\"click\",function(e){t=e.target.id;for(var n=0;n<o.length;n++)$(\"#\"+o[n].node.id).off(\"click\");for(n=0;n<r.length;n++)for(var i=0;i<r[n].rooms.length;i++)r[n].rooms[i].roomID===t&&(r[n].rooms[i].hasOwnProperty(\"nodes\")?alert(\"Cannot delete room. Node attached.\"):(this.instance.remove(),r[n].rooms.splice(i,1),o.splice(o.indexOf(n),1),delete a[t]));!0})}}),$(\"#drag\").on(\"click\",function(e){for(var o in a)a[o].node.children[0].instance.selectize(!1).resize(\"stop\"),a[o].draggable({snapToGrid:8}),a[o].off(\"dragend\"),a[o].on(\"dragend\",function(e){e.preventDefault();let o=e.target.children[0].id,n=e.target.firstChild.instance.x()+e.target.instance.transform().x,t=e.target.firstChild.instance.y()+e.target.instance.transform().y;if($(\"#\"+e.target.id).removeAttr(\"transform\"),$(\"#\"+e.target.children[0].id).attr(\"x\",n),$(\"#\"+e.target.children[0].id).attr(\"y\",t),e.target.children.length>1){let n=e.target.children[1].id,t=d(o,n),r=t[0],i=t[1];$(\"#\"+e.target.childNodes[1].id).removeAttr(\"transform\"),$(\"#\"+e.target.children[1].id).attr(\"x\",String(r)),$(\"#\"+e.target.children[1].id).attr(\"y\",String(i))}for(var i=0;i<r.length;i++)for(var a=0;a<r[i].rooms.length;a++)r[i].rooms[a].roomID===o&&(r[i].rooms[a].x=n,r[i].rooms[a].y=t);!0})}),$(\"#drag-node\").on(\"click\",function(o){for(var n in a){a[n].node.children[0].instance.selectize(!1).resize(\"stop\");for(var t=1;t<a[n].node.children.length;t++)a[n].node.childNodes[t].instance.draggable({snapToGrid:10}),a[n].node.childNodes[t].instance.off(\"dragend\"),a[n].node.childNodes[t].instance.on(\"dragend\",function(o){for(var n,t,i,a,s=o.target.instance.node.parentNode.firstChild.id,l=document.getElementById(e.node.id).getBoundingClientRect().x,c=document.getElementById(e.node.id).getBoundingClientRect().y,u=o.target.instance.node.id,m=0;m<r.length;m++)for(var g=0;g<r[m].rooms.length;g++)r[m].rooms[g].roomID===s&&(n=r[m].rooms[g].x,t=r[m].rooms[g].y,i=r[m].rooms[g].width,a=r[m].rooms[g].height);let f=(document.getElementById(u).getBoundingClientRect().x-l-n)/i,h=(document.getElementById(u).getBoundingClientRect().y-c-t)/a,p=d(s,u);p[0],p[1],o.target.getBoundingClientRect().x,o.target.getBoundingClientRect().y;for(m=0;m<r.length;m++)for(g=0;g<r[m].rooms.length;g++)if(r[m].rooms[g].hasOwnProperty(\"nodes\"))for(var y=0;y<r[m].rooms[g].nodes.length;y++)r[m].rooms[g].nodes[y].nodeID===u&&(r[m].rooms[g].nodes[y].x=f,r[m].rooms[g].nodes[y].y=h)});!0}}),$(\"#resize\").on(\"click\",function(){for(var o in a)a[o].draggable(!1);$(\"#svgGrid g rect\").each(function(){this.instance.selectize().resize(),$(\"#\"+this.instance.node.id).off(\"resizedone\"),$(\"#\"+this.instance.node.id).on(\"resizedone\",function(o){for(var n=o.target.id,i=document.getElementById(e.node.id).getBoundingClientRect().x,a=document.getElementById(e.node.id).getBoundingClientRect().y,s=document.getElementById(n).getBoundingClientRect().x-i,l=document.getElementById(n).getBoundingClientRect().y-a,c=document.getElementById(n).getBoundingClientRect().width,u=document.getElementById(n).getBoundingClientRect().height,m=0;m<r.length;m++)for(var g=0;g<r[m].rooms.length;g++)if(r[m].rooms[g].roomID===n){if(console.log(r[m].rooms[g].hasOwnProperty(\"nodes\")),r[m].rooms[g].hasOwnProperty(\"nodes\"))for(var f=0;f<r[m].rooms[g].nodes.length;f++){var h=r[m].rooms[g].nodes[f].nodeID,p=d(n,h),y=p[0],v=p[1];t[h].Icon.animate().move(y,v)}r[m].rooms[g].x=s,r[m].rooms[g].y=l,r[m].rooms[g].width=c,r[m].rooms[g].height=u}}),!0})}),$(\"#draw-room\").on(\"click\",function(){for(var n in e.panZoom(!1),a)a[n].node.children[0].instance.selectize(!1).resize(\"stop\");var t;e.on(\"mousedown\",function(o){(t=e.rect()).draw(o).attr({fill:\"white\",stroke:\"#E3E3E3\",\"stroke-width\":3})}),e.on(\"mouseup\",function(n){let s,d;t.draw(\"stop\"),e.off();let l=t.node.attributes[3].nodeValue,c=t.node.attributes[4].nodeValue,u=1,m=t.node.attributes[1].nodeValue,g=t.node.attributes[2].nodeValue;$.ajax({method:\"POST\",url:String(_config.api.inloApiUrl)+\"/v1/room\",headers:{Authorization:\"Bearer \"+getAuth(\"Authorization\")},success:function(n){s=n.roomID,d=n.timestamp;let f=s+\"group\",h=e.group().addClass(f),p={rooms:[{roomID:s,roomName:\"Kitchen\",floor:u,x:l,y:c,width:m,height:g}]};r[i].rooms.push(p.rooms[0]),o.push(t),h.add(o[o.length-1].addClass(f)),a[s]=h},error:function(e,o,n){console.error(\"Error requesting devices: \",o,\", Details: \",n),console.error(\"Response: \",e.responseText)}}),!0,e.panZoom({zoomMin:.5,zoomMax:2,zoomFactor:.1})})}),$(\"#draw-door\").on(\"click\",function(){for(var n=0;n<o.length;n++)o[n].selectize(!1).resize(\"stop\").draggable(!1);for(n=0;n<a.length;n++)a[n].ungroup(e),console.log(\"floorPlan[i] ungrouped\",a[n]);console.log(\"floorPlan after\",o);var t=document.getElementById(e.node.id).getBoundingClientRect().x,r=document.getElementById(e.node.id).getBoundingClientRect().y;document.addEventListener(\"click\",function(n){for(var i=n.clientX-t,a=n.clientY-r,s=0;s<o.length;s++){var d=Number(o[s].node.attributes[3].nodeValue),l=Number(o[s].node.attributes[4].nodeValue),c=Number(o[s].node.attributes[1].nodeValue),u=Number(o[s].node.attributes[2].nodeValue);if(i<d+10&&a>l+10&&i>d-10&&a<l+u-10)(m=e.line(i,a-10,i,a+10).stroke({color:\"#888888\",width:3})).node.attributes[3].nodeValue=Number(o[s].node.attributes[3].nodeValue),m.node.attributes[1].nodeValue=Number(o[s].node.attributes[3].nodeValue);else if(a<l+10&&i>d+10&&a>l-10&&i<d+c-10)(m=e.line(i-10,a,i+10,a).stroke({color:\"#888888\",width:3})).node.attributes[2].nodeValue=Number(o[s].node.attributes[4].nodeValue),m.node.attributes[4].nodeValue=Number(o[s].node.attributes[4].nodeValue);else if(i<d+c+10&&a>l+10&&i>d+c-10&&a<l+u-10)(m=e.line(i,a-10,i,a+10).stroke({color:\"#888888\",width:3})).node.attributes[3].nodeValue=Number(o[s].node.attributes[3].nodeValue)+c,m.node.attributes[1].nodeValue=Number(o[s].node.attributes[3].nodeValue)+c;else{if(!(a<l+u+10&&i>d+10&&a>l+u-10&&i<d+c-10))continue;var m;(m=e.line(i-10,a,i+10,a).stroke({color:\"#888888\",width:3})).node.attributes[2].nodeValue=Number(o[s].node.attributes[4].nodeValue)+u,m.node.attributes[4].nodeValue=Number(o[s].node.attributes[4].nodeValue)+u}}})})}),$(document).ready(function(){0===getAuth(\"Authorization\").length?window.location.href=\"signin.html\":document.getElementsByTagName(\"html\")[0].style.visibility=\"visible\",$(\"#items-listed-div\").hide(),$(\"#dropdown-sort-div\").hide(),$(\".home-icon\").click(function(){for(var e=document.getElementsByClassName(\"home-icon\"),o=document.getElementById(\"home-icon-svg\"),n=0;n<$(\".home-icon\").length;n++)e[n].attributes[4].nodeValue=\"#00D9A7\";o.style.borderBottom=\"6px solid #00D9A7\",o.style.paddingBottom=\".6em\"}),$(\"#dropdown-btn\").click(function(){$(\"#dropdown-menu\").toggle(500)})})},function(e,o){console.log(getAuth(\"Authorization\")),console.log(\"userID\",getAuth(\"userID\")),function e(){window.WebSocket=window.WebSocket||window.MozWebSocket;var o=new WebSocket(\"ws://api.theinlo.com/events\");console.log(getAuth(\"Authorization\"));var n={type:\"subscribe\",payload:{userID:\"487fb8be4234493ba37a59599d77f30b\"}};o.onopen=function(){o.send(JSON.stringify(n)),console.log(\"open\"),o.send(n)},o.onerror=function(e){console.log(e)},o.onmessage=function(e){try{var o=JSON.parse(e.data);console.log(o)}catch(o){return void console.log(\"This doesn't look like a valid JSON: \",e.data)}},o.onclose=function(o){console.log(o),console.log(\"closed\"),setTimeout(e,5e3)}}()}]);","extractedComments":[]}